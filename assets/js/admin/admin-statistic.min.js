import Chart from"chart.js/auto";document.addEventListener("DOMContentLoaded",(function(){const t=(t="today",e="")=>{wp.apiFetch({path:wp.url.addQueryArgs("lp/v1/statistics/overviews-statistics",{filtertype:t,date:e}),method:"GET"}).then((t=>{const{data:e,status:o,message:s}=t;if("error"===o)throw new Error(s||"Error");let n=Chart.getChart("net-sales-chart-content");if(document.getElementById("net-sales-chart-content").style.display="block",c(),void 0===n){const t={options:{scales:{y:{min:0,ticks:{callback:(t,e,o)=>"$"+t}}}}};n=r("net-sales-chart-content",e.chart_data,t)}else n.data.labels=e.chart_data.labels,n.data.datasets[0].data=e.chart_data.data,n.config.options.scales.x.title.text=e.chart_data.x_label,n.update();if(document.querySelector(".total-sales").textContent=e.total_sales,document.querySelector(".total-orders").textContent=e.total_orders,document.querySelector(".total-courses").textContent=e.total_courses,document.querySelector(".total-instructors").textContent=e.total_instructors,document.querySelector(".total-students").textContent=e.total_students,e.top_courses.length>0){const t=e.top_courses,o=document.querySelector(".top-course-sold");for(let e=0;e<t.length;e++)o.insertAdjacentHTML("beforeend",`<li>${t[e].course_name} - ${t[e].course_count}</li>`)}if(e.top_categories.length>0){const t=e.top_categories,o=document.querySelector(".top-category-sold");for(let e=0;e<t.length;e++)o.insertAdjacentHTML("beforeend",`<li>${t[e].term_name} - ${t[e].term_count}</li>`)}})).catch((t=>{console.log(t)})).finally((()=>{}))},e=(t="today",e="")=>{wp.apiFetch({path:wp.url.addQueryArgs("lp/v1/statistics/order-statistics",{filtertype:t,date:e}),method:"GET"}).then((t=>{const{data:e,status:o,message:s}=t;if("error"===o)throw new Error(s||"Error");let c=Chart.getChart("orders-chart-content"),n=document.getElementById("orders-chart-content");if(console.log(e),void 0===c?c=r("orders-chart-content",e.chart_data):(c.data.labels=e.chart_data.labels,c.data.datasets[0].data=e.chart_data.data,c.config.options.scales.x.title.text=e.chart_data.x_label,c.update()),n.style.display="block",e.statistics.length>0){let t=0;for(let o=e.statistics.length-1;o>=0;o--){const s=e.statistics[o];"completed"==s.order_status?(document.querySelector(".completed-order-count").textContent=s.count_order,t+=~~s.count_order):"pending"==s.order_status?(document.querySelector(".pending-order-count").textContent=s.count_order,t+=~~s.count_order):"processing"==s.order_status?(document.querySelector(".processing-order-count").textContent=s.count_order,t+=~~s.count_order):"cancelled"==s.order_status?(document.querySelector(".cancelled-order-count").textContent=s.count_order,t+=~~s.count_order):"failed"==s.order_status&&(document.querySelector(".failed-order-count").textContent=s.count_order,t+=~~s.count_order)}document.querySelector(".total-order-count").textContent=t}else document.querySelectorAll(".statistics-item-count").forEach((t=>{t.textContent=0}))})).catch((t=>{console.log(t)})).finally((()=>{}))},o=(t="today",e="")=>{wp.apiFetch({path:wp.url.addQueryArgs("lp/v1/statistics/course-statistics",{filtertype:t,date:e}),method:"GET"}).then((t=>{const{data:e,status:o,message:s}=t;if("error"===o)throw new Error(s||"Error");let n=Chart.getChart("course-chart-content");if(document.getElementById("course-chart-content").style.display="block",c(),void 0===n?n=r("course-chart-content",e.chart_data):(n.data.labels=e.chart_data.labels,n.data.datasets[0].data=e.chart_data.data,n.config.options.scales.x.title.text=e.chart_data.x_label,n.update()),e.courses.length>0){let t=0;for(let o=0;o<e.courses.length;o++){const s=e.courses[o];"publish"==s.course_status?(document.querySelector(".statistics-courses.published").textContent=s.course_count,t+=~~s.course_count):"pending"==s.course_status?(document.querySelector(".statistics-courses.pending").textContent=s.course_count,t+=~~s.course_count):"future"==s.course_status&&(document.querySelector(".statistics-courses.future").textContent=s.course_count,t+=~~s.course_count)}document.querySelector(".statistics-courses.total").textContent=t}else document.querySelectorAll(".statistics-courses").forEach((t=>{t.textContent=0}));if(e.items.length>0)for(let t=0;t<e.items.length;t++){const o=e.items[t];"lp_lesson"==o.item_type?document.querySelector(".statistics-items.lessons").textContent=o.item_count:"lp_quiz"==o.item_type?document.querySelector(".statistics-items.quizes").textContent=o.item_count:"lp_assignment"==o.item_type&&(document.querySelector(".statistics-items.assignment").textContent=o.item_count)}else document.querySelectorAll(".statistics-items").forEach((t=>{t.textContent=0}))})).catch((t=>{console.log(t)})).finally((()=>{}))},s=(t="today",e="")=>{wp.apiFetch({path:wp.url.addQueryArgs("lp/v1/statistics/user-statistics",{filtertype:t,date:e}),method:"GET"}).then((t=>{const{data:e,status:o,message:s}=t;if("error"===o)throw new Error(s||"Error");let n=Chart.getChart("user-chart-content");document.getElementById("user-chart-content").style.display="block",c(),void 0===n?n=r("user-chart-content",e.chart_data):(n.data.labels=e.chart_data.labels,n.data.datasets[0].data=e.chart_data.data,n.config.options.scales.x.title.text=e.chart_data.x_label,n.update());if(document.querySelector(".statistics-instructors").textContent=e.total_instructors,document.querySelector(".statistics-students").textContent=e.total_students,document.querySelector(".statistics-user-actived").textContent=e.total_instructors+e.total_students,document.querySelector(".statistics-not-started").textContent=e.user_not_start_course,e.user_course_statused.length>0){let t=e.user_course_statused,o=0;for(let e=0;e<t.length;e++)"in-progress"===t[e].graduation_status?document.querySelector(".statistics-graduration.in-progress").textContent=t[e].user_count:o+=~~t[e].user_count;document.querySelector(".statistics-graduration.finished").textContent=o}else document.querySelectorAll(".statistics-graduration").forEach((t=>{t.textContent=0}));if(Object.keys(e.top_enrolled_instructor).length>0){const t=e.top_enrolled_instructor,o=document.querySelector(".top-intructor-by-student");Object.keys(t).forEach((function(e){o.insertAdjacentHTML("beforeend",`<li>${t[e].name} - ${t[e].students}</li>`)}))}if(e.top_enrolled_courses.length>0){const t=e.top_enrolled_courses,o=document.querySelector(".top-course-by-student");for(let e=0;e<t.length;e++)o.insertAdjacentHTML("beforeend",`<li>${t[e].course_name} - ${t[e].enrolled_user}</li>`)}})).catch((t=>{console.log(t)})).finally((()=>{}))},r=(t="",e=[],o={})=>{const s=document.getElementById(t),r={type:"line",data:{labels:e.labels,datasets:[{label:e.line_label,borderColor:"rgb(49 74 199)",borderWidth:2,data:e.data,backgroundColor:"rgb(49 74 199)"}]},options:{responsive:!0,maintainAspectRatio:!1,aspectRatio:.8,plugins:{legend:{display:!1}},scales:{y:{min:0},x:{title:{display:!0,text:e.x_label,align:"end"}}}}},c={...r,...o};c.options={...r.options,...o.options},console.log(c);return new Chart(s,c)},c=(t=!1)=>{t?document.querySelectorAll(".lp-skeleton-animation").forEach((t=>{t.style.display="block"})):document.querySelectorAll(".lp-skeleton-animation").forEach((t=>{t.style.display="none"}))};document.querySelectorAll(".btn-filter-time").forEach((r=>{r.addEventListener("click",(()=>{document.querySelectorAll(".btn-filter-time").forEach((t=>t.classList.remove("active"))),r.classList.add("active");const n=r.dataset.filter;if("custom"==n)document.querySelector(".custom-filter-time").style.display="flex";else{const r=document.querySelector("input.statistics-type");r&&(document.querySelector(".statistics-content canvas").style.display="none",c(!0),"orders-statistics"==r.value?e(n):"overview-statistics"==r.value?(document.querySelector(".top-category-sold").innerHTML="",document.querySelector(".top-course-sold").innerHTML="",t(n)):"courses-statistics"==r.value?o(n):"users-statistics"==r.value&&(document.querySelector(".top-course-by-student").innerHTML="",document.querySelector(".top-intructor-by-student").innerHTML="",s(n)))}}))})),document.querySelector(".custom-filter-btn").addEventListener("click",(r=>{const n=document.querySelector("#ct-filter-1").value,a=document.querySelector("#ct-filter-2").value;if(n&&a){const r=document.querySelector("input.statistics-type");document.querySelector(".statistics-content canvas").style.display="none",c(!0),r&&("orders-statistics"==r.value?e("custom",`${n}+${a}`):"overview-statistics"==r.value?(document.querySelector(".top-category-sold").innerHTML="",document.querySelector(".top-course-sold").innerHTML="",t("custom",`${n}+${a}`)):"courses-statistics"==r.value?o("custom",`${n}+${a}`):"users-statistics"==r.value&&s("custom",`${n}+${a}`))}else alert("Choose date")})),(()=>{const r=document.querySelector("input.statistics-type");r&&("orders-statistics"===r.value?e():"overview-statistics"===r.value?t():"courses-statistics"===r.value?o():"users-statistics"===r.value&&s())})()}));